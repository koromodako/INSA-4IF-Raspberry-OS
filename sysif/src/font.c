#include <stdint.h>
#include "font.h"
#include "kheap.h"
#include "fb.h"

#define FONT_WIDTH 7
#define FONT_HEIGHT 13
#define FONT_TABLE_SIZE 128
#define LETTER_SPACING 2

typedef struct {
    char ** values;
} FontTable;

static FontTable* font;
static uint32_t cursor_x, cursor_y;
static uint32_t min_x, min_y, max_x, max_y;

static char char_font_33_bits[] = {0x00, 0x00, 0x07, 0x03, 0x03, 0x03, 0x01, 0x02, 0x07, 0x01, 0x00, 0x00, 0x00};
static char char_font_34_bits[] = {0x00, 0x1F, 0x1F, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static char char_font_35_bits[] = {0x00, 0x00, 0x1E, 0x1E, 0x1F, 0x0E, 0x1F, 0x1F, 0x0F, 0x00, 0x00, 0x00, 0x00};
static char char_font_36_bits[] = {0x00, 0x0C, 0x0C, 0x1E, 0x03, 0x0E, 0x1C, 0x30, 0x1E, 0x0E, 0x04, 0x00, 0x00};
static char char_font_37_bits[] = {0x00, 0x00, 0x17, 0x0F, 0x0F, 0x1F, 0x1E, 0x1E, 0x1B, 0x00, 0x00, 0x00, 0x00};
static char char_font_38_bits[] = {0x00, 0x00, 0x0E, 0x0E, 0x0E, 0x0F, 0x1F, 0x0F, 0x1E, 0x0A, 0x00, 0x00, 0x00};
static char char_font_39_bits[] = {0x00, 0x03, 0x07, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static char char_font_40_bits[] = {0x00, 0x0C, 0x06, 0x06, 0x03, 0x03, 0x03, 0x03, 0x02, 0x06, 0x0C, 0x04, 0x00};
static char char_font_41_bits[] = {0x00, 0x03, 0x06, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x06, 0x06, 0x03, 0x00, 0x00};
static char char_font_42_bits[] = {0x00, 0x00, 0x1E, 0x1E, 0x1E, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static char char_font_43_bits[] = {0x00, 0x00, 0x00, 0x00, 0x0C, 0x1F, 0x3E, 0x0C, 0x0C, 0x00, 0x00, 0x00, 0x00};
static char char_font_44_bits[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x0E, 0x0E, 0x06, 0x02, 0x00};
static char char_font_45_bits[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static char char_font_46_bits[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0x02, 0x00, 0x00, 0x00};
static char char_font_47_bits[] = {0x00, 0x10, 0x18, 0x18, 0x08, 0x0C, 0x0C, 0x04, 0x06, 0x06, 0x02, 0x00, 0x00};
static char char_font_48_bits[] = {0x00, 0x00, 0x1E, 0x1A, 0x37, 0x3F, 0x37, 0x12, 0x1E, 0x08, 0x00, 0x00, 0x00};
static char char_font_49_bits[] = {0x00, 0x00, 0x0C, 0x0E, 0x08, 0x0C, 0x0C, 0x08, 0x1E, 0x1C, 0x00, 0x00, 0x00};
static char char_font_50_bits[] = {0x00, 0x08, 0x1E, 0x12, 0x18, 0x18, 0x0C, 0x06, 0x1E, 0x1E, 0x00, 0x00, 0x00};
static char char_font_51_bits[] = {0x00, 0x00, 0x1E, 0x18, 0x1C, 0x1C, 0x30, 0x10, 0x1E, 0x06, 0x00, 0x00, 0x00};
static char char_font_52_bits[] = {0x00, 0x08, 0x1C, 0x0C, 0x1E, 0x1F, 0x1F, 0x1E, 0x18, 0x08, 0x00, 0x00, 0x00};
static char char_font_53_bits[] = {0x00, 0x00, 0x1E, 0x06, 0x06, 0x1E, 0x38, 0x10, 0x1E, 0x0A, 0x00, 0x00, 0x00};
static char char_font_54_bits[] = {0x00, 0x00, 0x1C, 0x06, 0x0E, 0x1F, 0x33, 0x33, 0x1E, 0x08, 0x00, 0x00, 0x00};
static char char_font_55_bits[] = {0x00, 0x04, 0x3F, 0x10, 0x18, 0x0C, 0x0C, 0x04, 0x04, 0x04, 0x00, 0x00, 0x00};
static char char_font_56_bits[] = {0x00, 0x04, 0x1E, 0x12, 0x1E, 0x1E, 0x16, 0x33, 0x1E, 0x08, 0x00, 0x00, 0x00};
static char char_font_57_bits[] = {0x00, 0x04, 0x1E, 0x13, 0x33, 0x3E, 0x1E, 0x18, 0x0E, 0x04, 0x00, 0x00, 0x00};
static char char_font_58_bits[] = {0x00, 0x00, 0x00, 0x02, 0x07, 0x03, 0x00, 0x03, 0x07, 0x02, 0x00, 0x00, 0x00};
static char char_font_59_bits[] = {0x00, 0x00, 0x00, 0x04, 0x06, 0x06, 0x00, 0x06, 0x06, 0x06, 0x06, 0x00, 0x00};
static char char_font_60_bits[] = {0x00, 0x00, 0x00, 0x00, 0x38, 0x1F, 0x0F, 0x1E, 0x10, 0x00, 0x00, 0x00, 0x00};
static char char_font_61_bits[] = {0x00, 0x00, 0x00, 0x00, 0x1E, 0x3F, 0x3F, 0x1E, 0x00, 0x00, 0x00, 0x00, 0x00};
static char char_font_62_bits[] = {0x00, 0x00, 0x00, 0x00, 0x0E, 0x1E, 0x3C, 0x1E, 0x03, 0x00, 0x00, 0x00, 0x00};
static char char_font_63_bits[] = {0x00, 0x04, 0x0F, 0x0C, 0x0C, 0x06, 0x02, 0x02, 0x06, 0x02, 0x00, 0x00, 0x00};
static char char_font_65_bits[] = {0x00, 0x00, 0x0C, 0x0E, 0x0E, 0x1A, 0x1F, 0x1F, 0x39, 0x01, 0x00, 0x00, 0x00};
static char char_font_66_bits[] = {0x00, 0x08, 0x1F, 0x13, 0x1F, 0x1F, 0x33, 0x33, 0x1F, 0x0C, 0x00, 0x00, 0x00};
static char char_font_67_bits[] = {0x00, 0x00, 0x3E, 0x06, 0x03, 0x03, 0x03, 0x02, 0x1E, 0x1C, 0x00, 0x00, 0x00};
static char char_font_68_bits[] = {0x00, 0x04, 0x1F, 0x1B, 0x33, 0x33, 0x33, 0x1B, 0x1F, 0x0C, 0x00, 0x00, 0x00};
static char char_font_69_bits[] = {0x00, 0x08, 0x0F, 0x01, 0x07, 0x0F, 0x01, 0x03, 0x1F, 0x07, 0x00, 0x00, 0x00};
static char char_font_70_bits[] = {0x00, 0x04, 0x0F, 0x01, 0x07, 0x0F, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00};
static char char_font_71_bits[] = {0x00, 0x00, 0x3E, 0x06, 0x03, 0x23, 0x33, 0x32, 0x3E, 0x1C, 0x00, 0x00, 0x00};
static char char_font_72_bits[] = {0x00, 0x00, 0x33, 0x33, 0x3F, 0x3F, 0x33, 0x33, 0x33, 0x02, 0x00, 0x00, 0x00};
static char char_font_73_bits[] = {0x00, 0x08, 0x0F, 0x06, 0x06, 0x06, 0x06, 0x06, 0x0F, 0x0D, 0x00, 0x00, 0x00};
static char char_font_74_bits[] = {0x00, 0x00, 0x1E, 0x10, 0x10, 0x10, 0x10, 0x18, 0x1E, 0x06, 0x00, 0x00, 0x00};
static char char_font_75_bits[] = {0x00, 0x00, 0x13, 0x1E, 0x0F, 0x0F, 0x0F, 0x1B, 0x32, 0x02, 0x00, 0x00, 0x00};
static char char_font_76_bits[] = {0x00, 0x00, 0x03, 0x01, 0x01, 0x01, 0x01, 0x03, 0x1F, 0x07, 0x00, 0x00, 0x00};
static char char_font_77_bits[] = {0x00, 0x00, 0x1B, 0x1F, 0x1F, 0x1F, 0x1F, 0x1B, 0x33, 0x00, 0x00, 0x00, 0x00};
static char char_font_78_bits[] = {0x00, 0x00, 0x37, 0x37, 0x1F, 0x3F, 0x3B, 0x3B, 0x33, 0x10, 0x00, 0x00, 0x00};
static char char_font_79_bits[] = {0x00, 0x04, 0x0E, 0x1B, 0x19, 0x33, 0x1B, 0x1B, 0x1F, 0x0C, 0x00, 0x00, 0x00};
static char char_font_80_bits[] = {0x00, 0x04, 0x1E, 0x33, 0x32, 0x1E, 0x0F, 0x02, 0x03, 0x00, 0x00, 0x00, 0x00};
static char char_font_81_bits[] = {0x00, 0x04, 0x0E, 0x1B, 0x13, 0x3B, 0x13, 0x1B, 0x1E, 0x0E, 0x1C, 0x08, 0x00};
static char char_font_82_bits[] = {0x00, 0x08, 0x1F, 0x13, 0x13, 0x1F, 0x1F, 0x1B, 0x32, 0x02, 0x00, 0x00, 0x00};
static char char_font_83_bits[] = {0x00, 0x08, 0x1E, 0x02, 0x06, 0x1E, 0x18, 0x30, 0x1F, 0x0C, 0x00, 0x00, 0x00};
static char char_font_84_bits[] = {0x00, 0x00, 0x1F, 0x0C, 0x0C, 0x04, 0x0C, 0x04, 0x0C, 0x00, 0x00, 0x00, 0x00};
static char char_font_85_bits[] = {0x00, 0x00, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x1E, 0x0C, 0x00, 0x00, 0x00};
static char char_font_86_bits[] = {0x00, 0x00, 0x33, 0x1B, 0x1B, 0x1B, 0x0E, 0x0E, 0x0E, 0x04, 0x00, 0x00, 0x00};
static char char_font_87_bits[] = {0x00, 0x00, 0x13, 0x13, 0x3F, 0x1F, 0x1F, 0x1F, 0x1B, 0x08, 0x00, 0x00, 0x00};
static char char_font_88_bits[] = {0x00, 0x00, 0x1B, 0x1E, 0x0E, 0x0E, 0x0E, 0x1A, 0x1B, 0x02, 0x00, 0x00, 0x00};
static char char_font_89_bits[] = {0x00, 0x00, 0x1B, 0x1B, 0x1E, 0x0E, 0x0E, 0x04, 0x0C, 0x00, 0x00, 0x00, 0x00};
static char char_font_90_bits[] = {0x00, 0x08, 0x3E, 0x18, 0x18, 0x0C, 0x06, 0x06, 0x3F, 0x1E, 0x00, 0x00, 0x00};
static char char_font_91_bits[] = {0x00, 0x1F, 0x07, 0x03, 0x03, 0x07, 0x07, 0x03, 0x06, 0x03, 0x0F, 0x08, 0x00};
static char char_font_93_bits[] = {0x00, 0x0F, 0x0C, 0x0C, 0x04, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0F, 0x04, 0x00};
static char char_font_94_bits[] = {0x00, 0x00, 0x0E, 0x0E, 0x1E, 0x13, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static char char_font_95_bits[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0x02, 0x00};
static char char_font_96_bits[] = {0x00, 0x06, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
static char char_font_97_bits[] = {0x00, 0x00, 0x00, 0x04, 0x1E, 0x3C, 0x3E, 0x13, 0x3E, 0x0C, 0x00, 0x00, 0x00};
static char char_font_98_bits[] = {0x00, 0x02, 0x02, 0x0F, 0x1F, 0x32, 0x32, 0x33, 0x1E, 0x0A, 0x00, 0x00, 0x00};
static char char_font_99_bits[] = {0x00, 0x00, 0x00, 0x18, 0x1E, 0x07, 0x03, 0x02, 0x1E, 0x1C, 0x00, 0x00, 0x00};
static char char_font_100_bits[] = {0x00, 0x18, 0x18, 0x1C, 0x1F, 0x1B, 0x1B, 0x1B, 0x1E, 0x0E, 0x00, 0x00, 0x00};
static char char_font_101_bits[] = {0x00, 0x00, 0x00, 0x04, 0x1F, 0x1F, 0x1F, 0x03, 0x1E, 0x0E, 0x00, 0x00, 0x00};
static char char_font_102_bits[] = {0x00, 0x3C, 0x04, 0x1E, 0x1F, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, 0x00, 0x00};
static char char_font_103_bits[] = {0x00, 0x00, 0x00, 0x04, 0x1E, 0x1B, 0x1B, 0x1B, 0x1F, 0x1C, 0x0F, 0x04, 0x00};
static char char_font_104_bits[] = {0x00, 0x02, 0x02, 0x0B, 0x1E, 0x13, 0x12, 0x12, 0x33, 0x00, 0x00, 0x00, 0x00};
static char char_font_105_bits[] = {0x00, 0x0C, 0x04, 0x02, 0x07, 0x0C, 0x04, 0x0C, 0x1C, 0x10, 0x00, 0x00, 0x00};
static char char_font_106_bits[] = {0x00, 0x18, 0x08, 0x0C, 0x1E, 0x18, 0x18, 0x18, 0x18, 0x18, 0x0E, 0x04, 0x00};
static char char_font_107_bits[] = {0x00, 0x02, 0x03, 0x02, 0x1B, 0x0E, 0x0E, 0x1B, 0x32, 0x02, 0x00, 0x00, 0x00};
static char char_font_108_bits[] = {0x00, 0x0F, 0x04, 0x0C, 0x04, 0x0C, 0x04, 0x0C, 0x1C, 0x10, 0x00, 0x00, 0x00};
static char char_font_109_bits[] = {0x00, 0x00, 0x00, 0x0A, 0x1F, 0x1F, 0x3F, 0x13, 0x13, 0x01, 0x00, 0x00, 0x00};
static char char_font_110_bits[] = {0x00, 0x00, 0x00, 0x04, 0x1E, 0x13, 0x32, 0x12, 0x33, 0x00, 0x00, 0x00, 0x00};
static char char_font_111_bits[] = {0x00, 0x00, 0x00, 0x04, 0x1F, 0x1B, 0x1B, 0x1B, 0x1E, 0x0C, 0x00, 0x00, 0x00};
static char char_font_112_bits[] = {0x00, 0x00, 0x00, 0x04, 0x1F, 0x32, 0x32, 0x33, 0x1E, 0x0F, 0x02, 0x00, 0x00};
static char char_font_113_bits[] = {0x00, 0x00, 0x00, 0x0C, 0x1F, 0x1B, 0x1B, 0x1B, 0x1E, 0x1C, 0x18, 0x00, 0x00};
static char char_font_114_bits[] = {0x00, 0x00, 0x00, 0x06, 0x0F, 0x03, 0x03, 0x03, 0x03, 0x01, 0x00, 0x00, 0x00};
static char char_font_115_bits[] = {0x00, 0x00, 0x00, 0x04, 0x1E, 0x07, 0x1E, 0x18, 0x1E, 0x0E, 0x00, 0x00, 0x00};
static char char_font_116_bits[] = {0x00, 0x00, 0x04, 0x1E, 0x1F, 0x04, 0x04, 0x04, 0x1C, 0x18, 0x00, 0x00, 0x00};
static char char_font_117_bits[] = {0x00, 0x00, 0x00, 0x00, 0x33, 0x12, 0x12, 0x12, 0x1E, 0x08, 0x00, 0x00, 0x00};
static char char_font_118_bits[] = {0x00, 0x00, 0x00, 0x00, 0x1B, 0x1B, 0x1E, 0x0E, 0x0E, 0x00, 0x00, 0x00, 0x00};
static char char_font_119_bits[] = {0x00, 0x00, 0x00, 0x00, 0x33, 0x1F, 0x1F, 0x1F, 0x1A, 0x0A, 0x00, 0x00, 0x00};
static char char_font_120_bits[] = {0x00, 0x00, 0x00, 0x00, 0x1F, 0x0E, 0x0C, 0x0E, 0x1B, 0x02, 0x00, 0x00, 0x00};
static char char_font_121_bits[] = {0x00, 0x00, 0x00, 0x00, 0x1B, 0x1B, 0x1E, 0x0E, 0x0C, 0x0C, 0x07, 0x02, 0x00};
static char char_font_122_bits[] = {0x00, 0x00, 0x00, 0x16, 0x1E, 0x1C, 0x0C, 0x06, 0x1E, 0x1E, 0x00, 0x00, 0x00};
static char char_font_123_bits[] = {0x00, 0x1C, 0x0C, 0x04, 0x0C, 0x06, 0x06, 0x04, 0x04, 0x0C, 0x1C, 0x00, 0x00};
static char char_font_124_bits[] = {0x00, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x01, 0x00};
static char char_font_125_bits[] = {0x00, 0x0E, 0x0C, 0x08, 0x0C, 0x18, 0x18, 0x08, 0x08, 0x0C, 0x0E, 0x00, 0x00};
static char char_font_126_bits[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x1F, 0x19, 0x00, 0x00, 0x00, 0x00, 0x00};

void initFont() {

    font = (FontTable *)kAlloc(sizeof (FontTable));
    font->values = (char **)kAlloc(FONT_TABLE_SIZE * sizeof (char *)); // ASCII Size Table

    for (int i = 0; i < FONT_TABLE_SIZE; ++i) {
        font->values[i] = char_font_63_bits;
    }

    font->values[33] = char_font_33_bits; // !
    font->values[34] = char_font_34_bits; // "
    font->values[35] = char_font_35_bits; // #
    font->values[36] = char_font_36_bits; // $
    font->values[37] = char_font_37_bits; // %
    font->values[38] = char_font_38_bits; // &
    font->values[39] = char_font_39_bits; // '
    font->values[40] = char_font_40_bits; // (
    font->values[41] = char_font_41_bits; // )
    font->values[42] = char_font_42_bits; // *
    font->values[43] = char_font_43_bits; // +
    font->values[44] = char_font_44_bits; // ,
    font->values[45] = char_font_45_bits; // -
    font->values[46] = char_font_46_bits; // .
    font->values[47] = char_font_47_bits; // /
    font->values[48] = char_font_48_bits; // 0
    font->values[49] = char_font_49_bits; // 1
    font->values[50] = char_font_50_bits; // 2
    font->values[51] = char_font_51_bits; // 3
    font->values[52] = char_font_52_bits; // 4
    font->values[53] = char_font_53_bits; // 5
    font->values[54] = char_font_54_bits; // 6
    font->values[55] = char_font_55_bits; // 7
    font->values[56] = char_font_56_bits; // 8
    font->values[57] = char_font_57_bits; // 9
    font->values[58] = char_font_58_bits; // :
    font->values[59] = char_font_59_bits; // ;
    font->values[60] = char_font_60_bits; // <
    font->values[61] = char_font_61_bits; // =
    font->values[62] = char_font_62_bits; // >
    font->values[63] = char_font_63_bits; // ?
    font->values[65] = char_font_65_bits; // A
    font->values[66] = char_font_66_bits; // B
    font->values[67] = char_font_67_bits; // C
    font->values[68] = char_font_68_bits; // D
    font->values[69] = char_font_69_bits; // E
    font->values[70] = char_font_70_bits; // F
    font->values[71] = char_font_71_bits; // G
    font->values[72] = char_font_72_bits; // H
    font->values[73] = char_font_73_bits; // I
    font->values[74] = char_font_74_bits; // J
    font->values[75] = char_font_75_bits; // K
    font->values[76] = char_font_76_bits; // L
    font->values[77] = char_font_77_bits; // M
    font->values[78] = char_font_78_bits; // N
    font->values[79] = char_font_79_bits; // O
    font->values[80] = char_font_80_bits; // P
    font->values[81] = char_font_81_bits; // Q
    font->values[82] = char_font_82_bits; // R
    font->values[83] = char_font_83_bits; // S
    font->values[84] = char_font_84_bits; // T
    font->values[85] = char_font_85_bits; // U
    font->values[86] = char_font_86_bits; // V
    font->values[87] = char_font_87_bits; // W
    font->values[88] = char_font_88_bits; // X
    font->values[89] = char_font_89_bits; // Y
    font->values[90] = char_font_90_bits; // Z
    font->values[91] = char_font_91_bits; // [
    font->values[93] = char_font_93_bits; // ]
    font->values[94] = char_font_94_bits; // ^
    font->values[95] = char_font_95_bits; // _
    font->values[96] = char_font_96_bits; // `
    font->values[97] = char_font_97_bits; // a
    font->values[98] = char_font_98_bits; // b
    font->values[99] = char_font_99_bits; // c
    font->values[100] = char_font_100_bits; // d
    font->values[101] = char_font_101_bits; // e
    font->values[102] = char_font_102_bits; // f
    font->values[103] = char_font_103_bits; // g
    font->values[104] = char_font_104_bits; // h
    font->values[105] = char_font_105_bits; // i
    font->values[106] = char_font_106_bits; // j
    font->values[107] = char_font_107_bits; // k
    font->values[108] = char_font_108_bits; // l
    font->values[109] = char_font_109_bits; // m
    font->values[110] = char_font_110_bits; // n
    font->values[111] = char_font_111_bits; // o
    font->values[112] = char_font_112_bits; // p
    font->values[113] = char_font_113_bits; // q
    font->values[114] = char_font_114_bits; // r
    font->values[115] = char_font_115_bits; // s
    font->values[116] = char_font_116_bits; // t
    font->values[117] = char_font_117_bits; // u
    font->values[118] = char_font_118_bits; // v
    font->values[119] = char_font_119_bits; // w
    font->values[120] = char_font_120_bits; // x
    font->values[121] = char_font_121_bits; // y
    font->values[122] = char_font_122_bits; // z
    font->values[123] = char_font_123_bits; // {
    font->values[124] = char_font_124_bits; // |
    font->values[125] = char_font_125_bits; // }
    font->values[126] = char_font_126_bits; // ~
}

void initCursor(uint32_t cur_min_x, uint32_t cur_min_y, uint32_t cur_max_x, uint32_t cur_max_y) {
    max_x = cur_max_x;
    max_y = cur_max_y;
    min_x = cur_min_x;
    min_y = cur_min_y;

    cursor_x = min_x;
    cursor_y = min_y;
}

/**
 * Vérification de la position du curseur et retour à la ligne (ou reset) en cas de dépassement de la zone
 */
void checkCursor() {
    if (cursor_x > max_x - FONT_WIDTH) {
        cursor_y += FONT_HEIGHT;
        cursor_x = min_x;
    }
    if (cursor_y > max_y - FONT_HEIGHT) {
        resetZone(min_x, min_y, max_x, max_y, 0, 0, 0);
        cursor_x = min_x;
        cursor_y = min_y;
    }
}

/**
 * Avance le curseur d'une lettre (plus l'espacement entre les lettres)
 */
void advanceCursor() {
    cursor_x += FONT_WIDTH; // Letter spacing
    checkCursor();
}

void drawLetter(char letter) {

    if (letter == '\n') { // Retour à la ligne

        cursor_y += FONT_HEIGHT;
        cursor_x = min_x;
        checkCursor();

    } else if (letter == ' ') {

        advanceCursor();

    } else if (33 <= (int)letter && 127 > (int)letter) {

        char * bitmapLetter = font->values[(int)letter];

        for (int line = 0; line < FONT_HEIGHT; ++line) {
            for (int col = 0; col < FONT_WIDTH; ++col) {
                if ((bitmapLetter[line] >> col) & 1) {
                    put_pixel_RGB24(cursor_x + col, cursor_y + line,255,255,255);
                } else {
                    put_pixel_RGB24(cursor_x + col, cursor_y + line,0,0,0);
                }
            }
        }
        advanceCursor();

    }
}

void drawLetters(char * letters) {

    for (int i = 0; letters[i] && letters[i] != '\0'; ++i) {
        drawLetter(letters[i]);
    }

}
